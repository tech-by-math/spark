<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="streamGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="processingGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mlGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="alertGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#43e97b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38f9d7;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dangerGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#feca57;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">
    Real-Time Fraud Detection Workflow
  </text>
  
  <!-- Data Ingestion Layer -->
  <g id="data-ingestion">
    <rect x="50" y="60" width="120" height="80" rx="10" fill="url(#streamGradient)" opacity="0.8"/>
    <text x="110" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
      Data Ingestion
    </text>
    
    <!-- Kafka Stream -->
    <circle cx="80" cy="110" r="12" fill="#667eea" opacity="0.9"/>
    <text x="80" y="114" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Kafka</text>
    <text x="80" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Transactions</text>
    
    <!-- Transaction Rate -->
    <circle cx="140" cy="110" r="12" fill="#764ba2" opacity="0.9"/>
    <text x="140" y="114" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="white">1M+/s</text>
    <text x="140" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Throughput</text>
  </g>
  
  <!-- Stream Processing Layer -->
  <g id="stream-processing">
    <rect x="200" y="60" width="150" height="80" rx="10" fill="url(#processingGradient)" opacity="0.8"/>
    <text x="275" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
      Stream Processing
    </text>
    
    <!-- Spark Streaming -->
    <rect x="210" y="100" width="40" height="25" rx="3" fill="#f093fb" opacity="0.9"/>
    <text x="230" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Spark</text>
    <text x="230" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Streaming</text>
    
    <!-- Micro-batches -->
    <rect x="260" y="100" width="40" height="25" rx="3" fill="#f5576c" opacity="0.9"/>
    <text x="280" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">1sec</text>
    <text x="280" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Batches</text>
    
    <!-- Processing Formula -->
    <text x="275" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">
      λ = partitions × cores / T_avg
    </text>
  </g>
  
  <!-- Feature Engineering Layer -->
  <g id="feature-engineering">
    <rect x="380" y="60" width="180" height="80" rx="10" fill="#E8F4FD" stroke="#4A90E2" stroke-width="2"/>
    <text x="470" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">
      Feature Engineering
    </text>
    
    <!-- Mathematical Transformations -->
    <g id="transformations">
      <text x="400" y="105" font-family="Arial, sans-serif" font-size="9" fill="#333">• log(amount)</text>
      <text x="400" y="118" font-family="Arial, sans-serif" font-size="9" fill="#333">• sin(hour × 2π/24)</text>
      <text x="480" y="105" font-family="Arial, sans-serif" font-size="9" fill="#333">• velocity score</text>
      <text x="480" y="118" font-family="Arial, sans-serif" font-size="9" fill="#333">• z-score deviation</text>
    </g>
    
    <!-- Feature Vector -->
    <text x="470" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      Feature Vector: [f₁, f₂, ..., fₙ]
    </text>
  </g>
  
  <!-- ML Model Layer -->
  <g id="ml-model">
    <rect x="50" y="180" width="200" height="120" rx="10" fill="url(#mlGradient)" opacity="0.8"/>
    <text x="150" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
      Machine Learning Models
    </text>
    
    <!-- Random Forest -->
    <g id="random-forest">
      <rect x="70" y="220" width="60" height="30" rx="5" fill="#4facfe" opacity="0.9"/>
      <text x="100" y="238" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Random</text>
      <text x="100" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Forest</text>
    </g>
    
    <!-- Isolation Forest -->
    <g id="isolation-forest">
      <rect x="140" y="220" width="60" height="30" rx="5" fill="#00f2fe" opacity="0.9"/>
      <text x="170" y="238" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Isolation</text>
      <text x="170" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Forest</text>
    </g>
    
    <!-- Mathematical Formulas -->
    <text x="150" y="270" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Anomaly Score = Σᵢ wᵢ × deviation(fᵢ)
    </text>
    <text x="150" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#E8F4FD">
      P(fraud) = sigmoid(Σᵢ wᵢ × fᵢ + bias)
    </text>
  </g>
  
  <!-- Scoring and Decision Layer -->
  <g id="scoring">
    <rect x="280" y="180" width="150" height="120" rx="10" fill="#FFF2E8" stroke="#E17055" stroke-width="2"/>
    <text x="355" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">
      Risk Scoring
    </text>
    
    <!-- Score Calculation -->
    <circle cx="320" cy="240" r="25" fill="#E17055" opacity="0.8"/>
    <text x="320" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Score</text>
    <text x="320" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">0.85</text>
    
    <!-- Threshold Decision -->
    <rect x="360" y="220" width="50" height="40" rx="5" fill="none" stroke="#E17055" stroke-width="2"/>
    <text x="385" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#333">Threshold</text>
    <text x="385" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#333">τ = 0.7</text>
    
    <!-- Decision Logic -->
    <text x="355" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">
      if score &gt; τ then FRAUD else NORMAL
    </text>
    <text x="355" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#888">
      Precision-Recall Optimized
    </text>
  </g>
  
  <!-- Alert and Action Layer -->
  <g id="alerts">
    <rect x="460" y="180" width="120" height="120" rx="10" fill="url(#alertGradient)" opacity="0.8"/>
    <text x="520" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">
      Alert System
    </text>
    
    <!-- Normal Transaction -->
    <circle cx="490" cy="235" r="18" fill="#43e97b" opacity="0.9"/>
    <text x="490" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">✓</text>
    <text x="490" y="242" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Normal</text>
    <text x="490" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#333">Pass Through</text>
    
    <!-- Fraud Alert -->
    <circle cx="550" cy="235" r="18" fill="#ff6b6b" opacity="0.9"/>
    <text x="550" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">!</text>
    <text x="550" y="242" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Fraud</text>
    <text x="550" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#333">Block &amp; Alert</text>
    
    <!-- Response Time -->
    <text x="520" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">
      Response: &lt; 100ms
    </text>
  </g>
  
  <!-- Historical Data and Model Training -->
  <g id="model-training">
    <rect x="600" y="180" width="150" height="120" rx="10" fill="url(#dangerGradient)" opacity="0.2" stroke="#ff6b6b" stroke-width="2"/>
    <text x="675" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">
      Model Training
    </text>
    
    <!-- Historical Data -->
    <rect x="620" y="220" width="50" height="25" rx="3" fill="#ff6b6b" opacity="0.7"/>
    <text x="645" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Historical</text>
    <text x="645" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Fraud Data</text>
    
    <!-- Model Updates -->
    <rect x="680" y="220" width="50" height="25" rx="3" fill="#feca57" opacity="0.7"/>
    <text x="705" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Online</text>
    <text x="705" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#333">Learning</text>
    
    <!-- Training Metrics -->
    <text x="675" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">
      Accuracy: 99.2%
    </text>
    <text x="675" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">
      FPR: &lt; 0.1%
    </text>
  </g>
  
  <!-- Data Flow Arrows -->
  <g id="data-flow">
    <!-- Ingestion to Processing -->
    <path d="M 170 100 L 200 100" stroke="#333" stroke-width="3" marker-end="url(#arrowhead)"/>
    
    <!-- Processing to Feature Engineering -->
    <path d="M 350 100 L 380 100" stroke="#333" stroke-width="3" marker-end="url(#arrowhead)"/>
    
    <!-- Feature Engineering to ML -->
    <path d="M 470 140 Q 470 160 300 180" stroke="#333" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
    
    <!-- ML to Scoring -->
    <path d="M 250 240 L 280 240" stroke="#333" stroke-width="3" marker-end="url(#arrowhead)"/>
    
    <!-- Scoring to Alerts -->
    <path d="M 430 240 L 460 240" stroke="#333" stroke-width="3" marker-end="url(#arrowhead)"/>
    
    <!-- Model Training Feedback -->
    <path d="M 675 300 Q 675 340 150 320 Q 150 310 150 300" stroke="#E17055" stroke-width="2" marker-end="url(#arrowhead)" fill="none" stroke-dasharray="5,5"/>
  </g>
  
  <!-- Performance Metrics -->
  <g id="performance-metrics">
    <rect x="50" y="340" width="700" height="80" rx="10" fill="#F8F9FA" stroke="#333" stroke-width="2"/>
    <text x="400" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      Mathematical Performance Metrics
    </text>
    
    <!-- Latency -->
    <text x="120" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#667eea">Latency:</text>
    <text x="120" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">E[T] = T_feature + T_model</text>
    <text x="120" y="412" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">≈ 50ms + 30ms</text>
    
    <!-- Throughput -->
    <text x="280" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f093fb">Throughput:</text>
    <text x="280" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">λ = N × C × U / T_avg</text>
    <text x="280" y="412" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">1.2M transactions/sec</text>
    
    <!-- Accuracy -->
    <text x="440" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#4facfe">Accuracy:</text>
    <text x="440" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Precision: 99.8%</text>
    <text x="440" y="412" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Recall: 95.2%</text>
    
    <!-- Scalability -->
    <text x="600" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#43e97b">Scalability:</text>
    <text x="600" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Linear scaling</text>
    <text x="600" y="412" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Up to 1000 nodes</text>
  </g>
  
  <!-- Mathematical Formulas Legend -->
  <g id="formulas">
    <rect x="50" y="450" width="700" height="120" rx="10" fill="#E8F4FD" stroke="#4A90E2" stroke-width="2"/>
    <text x="400" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">
      Key Mathematical Formulas
    </text>
    
    <!-- Anomaly Detection -->
    <text x="120" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#667eea">Anomaly Detection:</text>
    <text x="120" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Z-Score: z = (x - μ) / σ</text>
    <text x="120" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Modified: M = 0.6745(x - x̃)/MAD</text>
    <text x="120" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Isolation: AS = 2^(-E(h(x))/c(n))</text>
    
    <!-- Classification -->
    <text x="320" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f093fb">Classification:</text>
    <text x="320" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">P(fraud) = sigmoid(w·x + b)</text>
    <text x="320" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">ROC-AUC = ∫₀¹ TPR(FPR⁻¹(x))dx</text>
    <text x="320" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">F1 = 2PR/(P+R)</text>
    
    <!-- Performance -->
    <text x="520" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#4facfe">Performance:</text>
    <text x="520" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Latency: E[T] = Σᵢ T_stage_i</text>
    <text x="520" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Throughput: λ = N·C·U/T_avg</text>
    <text x="520" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Utilization: U = active_time/total_time</text>
    
    <!-- Business Impact -->
    <text x="680" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#43e97b">Business Impact:</text>
    <text x="680" y="515" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Savings = Prevented - FP_Cost</text>
    <text x="680" y="530" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">ROI = (S - C)/C × 100%</text>
    <text x="680" y="545" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Risk = P(fraud) × Loss_Amount</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
</svg>